<!DOCTYPE HTML>
<!--
	Forty by Pixelarity
	pixelarity.com | hello@pixelarity.com
	License: pixelarity.com/license
-->
<html>

<head>
	<title>VGDC@UCSD - Home</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="shortcut icon" type="image/png" href="images/favicon.png" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<script src="https://use.fontawesome.com/cc7ad2dbcf.js"></script>
	<noscript>
		<link rel="stylesheet" href="assets/css/noscript.css" />
	</noscript>
	<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script> -->

	<link rel="stylesheet"
		href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

	<script src="./assets/js/eventCard.js" type="module"></script>
	<script src="./const.js" type="module"></script>
	<link rel="stylesheet" href="style.css">
	<script type="module">

		import { API_KEY, SPREADSHEET_ID } from './const.js';
		const eventBin = document.getElementById("eventBin");


		window.addEventListener('trigger-calendar', function (event) {
			const link = event.detail;

			console.log('opening calendar with link: ', link)
			const newTab = window.open(link, '_blank');

			// Check if the new tab was successfully opened
			if (newTab) {
				newTab.focus();
			}
		})

		function gapiLoaded() {
			window.gapi.load('client', initializeGapiClient)
		}

		async function initializeGapiClient() {
			console.log("initializing");
			await window.gapi.client.init({
				'apiKey': API_KEY,
				discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
			}).then(function () {
				console.log("gapi initialized");
				readEvents();
			}).catch((error) => {
				console.log(error);
			})
		}

		async function readEvents() {
			window.gapi.client.sheets.spreadsheets.values.get({
				spreadsheetId: SPREADSHEET_ID,
				range: 'Sheet1!A2:G'
			}).then((response) => {
				const events = response.result.values;
				if (events.length != 0) {
					console.log(events);
					const currentDate = new Date();
					const filteredEvents = events.filter((event) => {
						const eventDate = new Date(event[3] + ' ' + event[5]);
						return currentDate <= eventDate;
					})

					if (filteredEvents.length == 0) {
						console.log("no upcoming events")
						const noData = document.querySelector("div#noData");
						noData.style.display = "block"
					}
					else {
						displayData(filteredEvents)
					}
				}
				else {
					const noData = document.querySelector("div#noData");
					noData.style.display = "block"
					console.log('no data')

				}
			}).catch((error) => {
				console.log(error)
			})
		}

		function displayData(events) {


			console.log('displaying events')


			eventBin.querySelectorAll('event-card').forEach((card) => {
				card.remove();
			})

			events.forEach((event) => {

				const eventObject = {
					"title": event[0],
					"description": event[1],
					"location": event[2],
					"date": event[3],
					"start_time": event[4],
					"end_time": event[5],
					"photo_url": event[6]
				}

				const eventCard = document.createElement("event-card");
				eventCard.data = eventObject;
				console.log(eventCard)
				eventBin.appendChild(eventCard);
				console.log("added card")

			})
		}

		window.gapiLoaded = gapiLoaded;

	</script>

	<script src="https://apis.google.com/js/api.js" onload="window.gapiLoaded()" type="module"></script>


</head>

<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Header -->
		<header id="header" class="alt">
			<a href="./" class="logo"> <span>Video Game Development Club @ UC San Diego</span></a>
			<nav>
				<a href="#menu">Menu</a>
			</nav>
		</header>

		<!-- Menu -->
		<nav id="menu">
			<ul class="links">
				<li><a href="./">Home</a></li>
				<li><a href="officers.html">Current Officers</a></li>
				<!--<li><a href="winterShowcase2022.html">Winter Showcase</a></li>-->
				<li><a href="https://vgdcgamejam.itch.io/">Previous Game Jams</a></li>
			</ul>
			<ul class="actions stacked">
				<li><a href="https://bit.ly/VGDCUCSD" class="button primary fit">Discord</a></li>
				<li><a href="https://www.facebook.com/groups/VGDC.UCSD/" class="button fit">Facebook Group</a></li>
			</ul>
		</nav>

		<!-- Banner -->
		<section id="banner" class="major">
			<div class="inner">
				<header class="major">
					<span class="inner">
						<img src="images/logo.png" class="logoImage" alt="Welcome to VGDC" />
						<!-- logo added by Matthew -->
					</span>
				</header>
				<div class="content">
					<p id="introContent"></p>
					<p>Come join our game-making community!</p>
					<!-- hard coded intro(?) added by Matthew (fixes fade-in effect) -->
					<ul class="icons">
						<li><a href="https://bit.ly/VGDCUCSD" class="icon brands alt fa-discord"><span
									class="label">Discord</span></a></li>
						<li><a href="https://www.facebook.com/groups/VGDC.UCSD/"
								class="icon brands alt fa-facebook-f"><span class="label">Facebook</span></a></li>
						<li><a href="https://www.instagram.com/vgdc.ucsd/"
								class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="mailto:vgdc@ucsd.edu" class="icon alt solid fa-envelope"><span
								class="label"></span></a></li>
					</ul>
				</div>
			</div>
		</section>

		<!-- Main -->
		<div id="main">

			<!-- One -->
			<section id="one" class="tiles">
				<article>
					<span class="image">
						<img src="images/pic01.jpg" alt="" />
					</span>
					<header class="major">
						<h3><a href="https://store.steampowered.com/app/1005870/HYPERFIGHT/" class="link">Hyperfight</a>
						</h3>
						<p>A sick one hit fighter.</p>
					</header>
				</article>
				<article>
					<span class="image">
						<img src="images/pic02.jpg" alt="" />
					</span>
					<header class="major">
						<h3><a href="https://store.steampowered.com/app/1588250/Contract_Killer/" class="link">Contract
								Killer</a></h3>
						<p>Pencil-packed CO-OP beat 'em up!</p>
					</header>
				</article>
				<article>
					<span class="image">
						<img src="images/pic03.jpg" alt="" />
					</span>
					<header class="major">
						<h3><a href="https://www.kickstarter.com/projects/longstorystudios/unit-108/description?lang=it"
								class="link">Unit 108</a></h3>
						<p>A stylistic 2D Platformer</p>
					</header>
				</article>
				<article>
					<span class="image">
						<img src="images/pic04.jpg" alt="" />
					</span>
					<header class="major">
						<h3><a href="https://www.indiecade.com/patricks-parabox/" class="link">Patricks Parabox</a></h3>
						<p>A recursive puzzler. (Winner of Developers Choice at Indiecade!!!)</p>
					</header>
				</article>
			</section>

			<!-- Two -->
			<section id="two">
				<div class="inner">
					<header class="major">
						<h2>What's New</h2>
					</header>

					<li><b><a href="winterShowcase2022.html">Winter Showcase!!!</a></b>
					</li>
				</div>
				<div class="inner">
					<header class="major">
						<h2>Our Upcoming Events</h2>
					</header>
					<div id="eventBin">

					</div>
					<div id="noData" style="display: none">
						<p>No Upcoming Events</p>
					</div>
					<p>Join our <a href="https://bit.ly/VGDCUCSD"><b>Discord</b></a> for up-to-date event announcements!
					</p>
				</div>
			</section>

		</div>

		<!-- Footer -->
		<footer id="footer">
			<div class="inner">
				<ul class="icons" style="display: inline;">
					<!-- <li><a href="mailto:vgdc@ucsd.edu" class="icon alt solid fa-envelope"><span
								class="label"></span></a></li> -->
					<li><a href="https://bit.ly/VGDCUCSD" class="icon brands alt fa-discord"><span
								class="label">Discord</span></a></li>
					<li><a href="https://www.facebook.com/groups/VGDC.UCSD/" class="icon brands alt fa-facebook-f"><span
								class="label">Facebook</span></a></li>
					<li><a href="https://www.instagram.com/vgdc.ucsd/"
							class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>
					<li><a href="https://vgdcgamejam.itch.io/" class="icon brands alt solid fa-itch-io"><span
								class="label"></span></a></li>
					<li><a href="mailto:vgdc@ucsd.edu">vgdc@ucsd.edu</a></li>
				</ul>
			</div>
		</footer>

	</div>

	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/jquery.scrolly.min.js"></script>
	<script src="assets/js/jquery.scrollex.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>
	<script src="assets/js/dataHandle.js"></script>
</body>

</html>